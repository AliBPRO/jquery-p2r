+function(a){"use strict";var b=function(b,c){this.$element=a(b),this.options=a.extend({},self.DEFAULTS,c),this.flags={moving:!1,touched:!1,isTouch:!1,refreshed:!1},this.positions={startY:0,startX:0,lastStep:0}};b.key="pulltorefresh",b.DEFAULTS={sensibility:10,refresh:100,lockRefresh:!1,resetRefresh:!1,autoInit:!0,resetSpeed:"100ms",simulateTouch:!0,threshold:10},b.namespace=function(a){return[a,b.key].join(".")},b.prototype.construct=function(){var c=this;c.$element.on(b.events.start,c.proxy(c.onTouchStart,c)).on(b.events.move,c.proxy(c.onTouchMove,c)).on(b.events.end,c.proxy(c.onTouchEnd,c)),c.options.simulateTouch&&(c.$element.on(c.namespace("mousedown"),c.proxy(c.onTouchStart,c)),a(document).on(c.namespace("mousemove"),c.$element,c.proxy(c.onTouchMove,c)).on(c.namespace("mouseup"),c.$element,c.proxy(c.onTouchEnd,c)))},b.prototype.destroy=function(){this.$element.off(this.namespace("")),a(document).off(this.namespace(""))},b.support={touch:window.Modernizr&&Modernizr.touch===!0||function(){return!!("ontouchstart"in window||window.DocumentTouch&&document instanceof DocumentTouch)}(),transforms3d:window.Modernizr&&Modernizr.csstransforms3d===!0||function(){var a=document.createElement("div").style;return"webkitPerspective"in a||"MozPerspective"in a||"OPerspective"in a||"MsPerspective"in a||"perspective"in a}(),transforms:window.Modernizr&&Modernizr.csstransforms===!0||function(){var a=document.createElement("div").style;return"transform"in a||"WebkitTransform"in a||"MozTransform"in a||"msTransform"in a||"MsTransform"in a||"OTransform"in a}(),transitions:window.Modernizr&&Modernizr.csstransitions===!0||function(){var a=document.createElement("div").style;return"transition"in a||"WebkitTransition"in a||"MozTransition"in a||"msTransition"in a||"MsTransition"in a||"OTransition"in a}(),classList:function(){var a=document.createElement("div").style;return"classList"in a}(),browser:{ie8:function(){var a=-1;if("Microsoft Internet Explorer"===navigator.appName){var b=navigator.userAgent,c=new RegExp(/MSIE ([0-9]{1,}[\.0-9]{0,})/);null!==c.exec(b)&&(a=parseFloat(RegExp.$1))}return-1!==a&&9>a}(),ie10:!!window.navigator.msPointerEnabled,ie11:!!window.navigator.pointerEnabled}},b.events=function(){if(b.support.touch)return{start:b.namespace("touchstart"),move:b.namespace("touchmove"),end:b.namespace("touchend")};var a={start:b.namespace("mousedown"),move:b.namespace("mousemove"),end:b.namespace("mouseup")};return window.navigator.msPointerEnabled&&(a={start:b.namespace("MSPointerDown"),move:b.namespace("MSPointerMove"),end:b.namespace("MSPointerUp")}),window.navigator.pointerEnabled&&(a={start:b.namespace("pointerdown"),move:b.namespace("pointermove"),end:b.namespace("pointerup")}),a}(),b.prototype.proxy=function(){var b=!!Function.prototype.bind;return b?function(a,b){return a.bind(b)}:a.proxy?a.proxy:function(a,b){var c,d,e;return"string"==typeof b&&(c=a[b],b=a,a=c),"function"==typeof a?void 0:(d=Array.prototype.slice.call(arguments,2),e=function(){return a.apply(b||this,d.concat(slice.call(arguments)))},e.guid=a.guid=a.guid||jQuery.guid++,e)}}(),b.prototype.transform=function(a,b){a.webkitTransform="translate(0, "+b+"px) "+"translateZ(0)",a.msTransform=a.MsTransform=a.MozTransform=a.OTransform=a.transform="translateY("+b+"px)"},b.prototype.transition=function(a,b){a.webkitTransitionDuration=a.MozTransitionDuration=a.msTransitionDuration=a.OTransitionDuration=a.transitionDuration=b},b.prototype.getAxis=function(a,b){return{x:b?(a.targetTouches||a.originalEvent.targetTouches)[0].pageX:a.pageX||a.clientX,y:b?(a.targetTouches||a.originalEvent.targetTouches)[0].pageY:a.pageY||a.clientY}},b.prototype.onTouchStart=function(a){var b="touchstart"===a.type;if(b||1===a.which){this.flags.touched=!0,this.flags.refreshed=!1,this.flags.isTouch="touchstart"===a.type;var c=this.getAxis(a,b);this.positions.startY=c.y,this.positions.startX=c.x,this.$element.trigger(this.namespace("start")),this.transition(this.$element[0].style,"0ms"),a.stopPropagation(),a.preventDefault()}},b.prototype.onTouchMove=function(a){var c,d,e,f,b="touchmove"===a.type;if(this.flags.touched&&(!this.flags.isTouch||"mousemove"!==a.type)){if(f=this.getAxis(a,b),c=f.y-this.positions.startY,f.x-this.positions.startX>this.options.threshold)return this.reset(),void 0;if(!(0>c)){if(c>=this.options.refresh&&!this.flags.refreshed){if(this.$element.trigger(this.namespace("refresh")),this.flags.refreshed=!0,this.options.resetRefresh)return this.reset(),void 0;if(this.options.lockRefresh)return}d=parseInt(c/this.options.sensibility,10),this.positions.lastStep!=d&&(this.positions.lastStep=d,e=parseInt(c/100*this.options.refresh,10),this.$element.trigger(this.namespace("move"),e)),this.transform(this.$element[0].style,c)}}},b.prototype.reset=function(){this.transition(this.$element[0].style,this.options.resetSpeed),this.transform(this.$element[0].style,0),this.flags.touched=!1,this.flags.isTouch=!1,this.flags.refreshed=!1,this.positions.startY=!1},b.prototype.onTouchEnd=function(a){this.flags.touched&&(this.positions.startY=0,this.positions.startX=0,this.reset(),this.$element.trigger(this.namespace("end")),a.stopPropagation(),a.preventDefault())};var c=a.fn.pullToRefresh;a.fn.pullToRefresh=function(c){return this.each(function(){var d=a(this),e=d.data(b.key),f=a.extend({},b.DEFAULTS,d.data(),"object"==typeof c&&c);(e||"destroy"!=c)&&(e||(d.data(b.key,e=new b(this,f)),f.autoInit&&e.construct()),"string"==typeof c&&e[c].apply(e))})},a.fn.pullToRefresh.Constructor=b,a.fn.pullToRefresh.noConflict=function(){return a.fn.pullToRefresh=c,this}}(window.jQuery||window.Zepto);